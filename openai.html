<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>OpenAI 文件理解 Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        #output {
            white-space: pre-wrap;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <h2>OpenAI 文件理解 Demo</h2>
    <input type="file" id="fileInput" accept=".txt" />
    <button onclick="handleFile()">上传并解析</button>

    <div id="output"></div>

    <script>
        const apiKey = 'sk-3e9176f8daa64c29a19e6d26f23de78d'; // ⚠️ 安全起见，请不要将 API Key 暴露在前端

        async function handleFile() {
            const fileInput = document.getElementById('fileInput');
            const output = document.getElementById('output');
            const file = fileInput.files[0];

            if (!file) {
                alert('请选择一个文本文件');
                return;
            }

            const text = await file.text();

            output.textContent = "正在分析文件内容，请稍候...";

            // 请求 OpenAI Chat API
            const response = await fetch("https://dashscope.aliyuncs.com/compatible-mode/v1", {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${apiKey}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    model: "qwen-vl-max",
                    messages: [
                        { role: "system", content: "你是一个善于总结的助手。" },
                        { role: "user", content: `请帮我总结以下文件内容：\n\n${text}` }
                    ],
                    temperature: 0.7
                })
            });

            const result = await response.json();
            output.textContent = result.choices?.[0]?.message?.content || "解析失败";
        }
    </script>
</body>

</html>